

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>mtk.ga.normalization module &mdash; mtk  documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="mtk  documentation" href="index.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> mtk
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li><a class="reference internal" href="#">mtk.ga.normalization module</a><ul>
<li><a class="reference internal" href="#extending-mmea-adding-normalization-functions">Extending MMEA: Adding normalization functions.</a></li>
</ul>
</li>
</ul>
</div>
            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">mtk</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>mtk.ga.normalization module</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/mtk.ga.normalization.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-mtk.ga.normalization">
<span id="mtk-ga-normalization-module"></span><h1>mtk.ga.normalization module<a class="headerlink" href="#module-mtk.ga.normalization" title="Permalink to this headline">¶</a></h1>
<p>Defines normalization functions via the Normalization class.</p>
<p>Normalization functions are functions that recalculate the fitness
values of members in a population. The difference between fitness
and normalization functions is that fitness functions are only use the
MacroMolecule to calculate its fitness. Normalzation functions have
access to all MacroMolecules in a population. As a result they can
scale the fitness values across the entire population. This is useful
if you want to ensure a spread of fitness values in the population.</p>
<p>Each generation, a number of normalizatoin functions can be applied
in sequence.</p>
<div class="section" id="extending-mmea-adding-normalization-functions">
<h2>Extending MMEA: Adding normalization functions.<a class="headerlink" href="#extending-mmea-adding-normalization-functions" title="Permalink to this headline">¶</a></h2>
<p>If a new normalization function is to be added to MMEA it should be
added as a method in the <code class="docutils literal"><span class="pre">Normalization</span></code> class defined in this
module. The only requirements are that the first argument is
<code class="docutils literal"><span class="pre">population</span></code> (excluding <code class="docutils literal"><span class="pre">self</span></code>).</p>
<p>The naming requirement exists to help users identify which arguments
are handled automatically by MMEA and which they need to define in the
input file. The convention is that if the normalization function takes
an argument called  <code class="docutils literal"><span class="pre">population</span></code> it does not have to be specified in
the input file.</p>
<p>Normalization functions should not interact with the <cite>unscaled_fitness</cite>
attribute in any way. They should only modify the value in <cite>fitness</cite>.
Before the first normalization function is applied each generation, the
value in <cite>unscaled_fitness</cite> is copied into <cite>fitness</cite>. This happens
automatically.</p>
<p>Normalization functions calculate the fitness value of a molecule and
place it in the <cite>fitness</cite> attribute. Multiple normalization functions
can be applied in sequence. Only the last normalization function
applied needs to place a value between 0 (exlusive) and infinity in the
<cite>fitness</cite> attribute. The others can do whatever scaling is necessary
to for the problem at hand.</p>
<p>If a normalization function does not fit neatly into a single function
make sure that any helper functions are private, ie that their names
start with a leading underscore.</p>
<dl class="class">
<dt id="mtk.ga.normalization.Normalization">
<em class="property">class </em><code class="descclassname">mtk.ga.normalization.</code><code class="descname">Normalization</code><span class="sig-paren">(</span><em>funcs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mtk/ga/normalization.html#Normalization"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mtk.ga.normalization.Normalization" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>A class for carrying out normalization of fitness values.</p>
<dl class="attribute">
<dt id="mtk.ga.normalization.Normalization.scaling_func">
<code class="descname">scaling_func</code><a class="headerlink" href="#mtk.ga.normalization.Normalization.scaling_func" title="Permalink to this definition">¶</a></dt>
<dd><p><em>functools. partial</em></p>
</dd></dl>

<dl class="method">
<dt id="mtk.ga.normalization.Normalization.__call__">
<code class="descname">__call__</code><span class="sig-paren">(</span><em>population</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mtk/ga/normalization.html#Normalization.__call__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mtk.ga.normalization.Normalization.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies the normalization function on <cite>population</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>population</strong> (<a class="reference internal" href="mtk.ga.population.html#mtk.ga.population.Population" title="mtk.ga.population.Population"><em>Population</em></a>) – The population whose members need to have their fitness
values normalized.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="mtk.ga.normalization.Normalization.__dict__">
<code class="descname">__dict__</code><em class="property"> = mappingproxy({'divide': &lt;function Normalization.divide&gt;, '__weakref__': &lt;attribute '__weakref__' of 'Normalization' objects&gt;, '__doc__': '\n    A class for carrying out normalization of fitness values.\n\n    Attributes\n    ----------\n    scaling_func : functools. partial\n\n    ', '__module__': 'mtk.ga.normalization', '__init__': &lt;function Normalization.__init__&gt;, '__dict__': &lt;attribute '__dict__' of 'Normalization' objects&gt;, 'combine': &lt;function Normalization.combine&gt;, 'shift_elements': &lt;function Normalization.shift_elements&gt;, '__call__': &lt;function Normalization.__call__&gt;, 'cage': &lt;function Normalization.cage&gt;, 'invert': &lt;function Normalization.invert&gt;, 'magnitudes': &lt;function Normalization.magnitudes&gt;})</em><a class="headerlink" href="#mtk.ga.normalization.Normalization.__dict__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="mtk.ga.normalization.Normalization.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>funcs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mtk/ga/normalization.html#Normalization.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mtk.ga.normalization.Normalization.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initializes a Normalization instance.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>funcs</strong> (<em>list of FunctionData instances</em>) – Holds all the normalization functions to be applied each
generation, in the order in which they are to be applied.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="mtk.ga.normalization.Normalization.__module__">
<code class="descname">__module__</code><em class="property"> = 'mtk.ga.normalization'</em><a class="headerlink" href="#mtk.ga.normalization.Normalization.__module__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="mtk.ga.normalization.Normalization.__weakref__">
<code class="descname">__weakref__</code><a class="headerlink" href="#mtk.ga.normalization.Normalization.__weakref__" title="Permalink to this definition">¶</a></dt>
<dd><p>list of weak references to the object (if defined)</p>
</dd></dl>

<dl class="method">
<dt id="mtk.ga.normalization.Normalization.cage">
<code class="descname">cage</code><span class="sig-paren">(</span><em>population</em>, <em>cavity</em>, <em>window</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mtk/ga/normalization.html#Normalization.cage"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mtk.ga.normalization.Normalization.cage" title="Permalink to this definition">¶</a></dt>
<dd><p>A normalization function for the <cite>cage</cite> fitness function.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>population</strong> (<a class="reference internal" href="mtk.ga.population.html#mtk.ga.population.Population" title="mtk.ga.population.Population"><em>Population</em></a>) – The population whose members need to have their fitness
values normalized.</li>
<li><strong>cavity</strong> (<em>float</em>) – The desired size of the cage cavity.</li>
<li><strong>window</strong> (<em>float</em>) – The desired size of the largest cage window.</li>
<li><strong>Modifies</strong> – </li>
<li><strong>--------</strong> – </li>
<li><strong>fitness</strong> (<em>numpy.array</em>) – The fitness attribute of members is updated.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>None</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">NoneType</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mtk.ga.normalization.Normalization.combine">
<code class="descname">combine</code><span class="sig-paren">(</span><em>population</em>, <em>coefficients</em>, <em>exponents</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mtk/ga/normalization.html#Normalization.combine"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mtk.ga.normalization.Normalization.combine" title="Permalink to this definition">¶</a></dt>
<dd><p>Combines elements in the <cite>fitness</cite> attribute of members.</p>
<p>This function assumes that the <cite>fitness</cite> attribute
of the population’s members is an array. It raises the members
of the array to the values in <cite>exponents</cite> and then multiplies
them with the values in <cite>coefficients</cite>. Lastly, the individual
array elements are summed to create a final value.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>population</strong> (<a class="reference internal" href="mtk.ga.population.html#mtk.ga.population.Population" title="mtk.ga.population.Population"><em>Population</em></a>) – The population whose members need to have their fitness
values normalized.</li>
<li><strong>coefficients</strong> (<em>list of ints</em><em> or </em><em>floats</em>) – Before summing all the elements in the <cite>fitness</cite> attribute,
their values are multiplied by the numbers in this list.</li>
<li><strong>exponents</strong> (<em>list of ints</em><em> or </em><em>floats</em>) – Before summing all the elements in the <cite>fitness</cite> attribute,
their values are raised to the numbers in this list.</li>
<li><strong>Modifies</strong> – </li>
<li><strong>--------</strong> – </li>
<li><strong>fitness</strong> (<em>numpy.array</em>) – This attribute is altered for the populations members. It
is changed from an array to a float.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>None</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">NoneType</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mtk.ga.normalization.Normalization.divide">
<code class="descname">divide</code><span class="sig-paren">(</span><em>population</em>, <em>val</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mtk/ga/normalization.html#Normalization.divide"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mtk.ga.normalization.Normalization.divide" title="Permalink to this definition">¶</a></dt>
<dd><p>Divides each fitness value by <cite>val</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>population</strong> (<a class="reference internal" href="mtk.ga.population.html#mtk.ga.population.Population" title="mtk.ga.population.Population"><em>Population</em></a>) – The population being normalized.</li>
<li><strong>val</strong> (<em>numerical</em><em> or </em><em>numpy.array of numericals</em>) – The value by which each fitness value is divided.</li>
<li><strong>Modifies</strong> – </li>
<li><strong>--------</strong> – </li>
<li><strong>fitness</strong> (<em>numerical</em><em> or </em><em>numpy.array of numericals</em>) – Each fitness value of a population member is divided by
<cite>val</cite>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>None</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">NoneType</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mtk.ga.normalization.Normalization.invert">
<code class="descname">invert</code><span class="sig-paren">(</span><em>population</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mtk/ga/normalization.html#Normalization.invert"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mtk.ga.normalization.Normalization.invert" title="Permalink to this definition">¶</a></dt>
<dd><p>Convertes a fitness value to 1/fitness.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>population</strong> (<a class="reference internal" href="mtk.ga.population.html#mtk.ga.population.Population" title="mtk.ga.population.Population"><em>Population</em></a>) – The population to be normalized.</li>
<li><strong>Modifies</strong> – </li>
<li><strong>--------</strong> – </li>
<li><strong>fitness</strong> (<em>float</em>) – The <cite>fitness</cite> attribute of the population’s members is
changed to 1/<cite>fitness</cite>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>None</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">NoneType</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mtk.ga.normalization.Normalization.magnitudes">
<code class="descname">magnitudes</code><span class="sig-paren">(</span><em>population</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mtk/ga/normalization.html#Normalization.magnitudes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mtk.ga.normalization.Normalization.magnitudes" title="Permalink to this definition">¶</a></dt>
<dd><p>Normalizes the relative values of elements in <cite>fitness</cite>.</p>
<p>This normalization function assumes that the value in <cite>fitness</cite>
is a numpy array:</p>
<blockquote>
<div>macro_mol.fitness = np.array([1000, 5e-5, 25])</div></blockquote>
<p>Notice that each element has a very different order of
magnitude. For example if the fitness function calculated the
energy value of the molecule, its radius and the number of
atoms in it, this could be the data placed in the <cite>fitness</cite>
attribute.</p>
<p>When calculating the total fitness based on these values, it
would be useful to make them comparable. As it is, you can’t
compare 10,000 kJ mol-1 and 5e-5 Angstroms. However what you
can do is check how much bigger or smaller than average
10,000 kJ mol-1 and 5e-5 Angstrom are. Then replace these
values with the size relative to the average. For example:</p>
<blockquote>
<div>macro_mol.fitness = np.array([2, 0.5, 3])</div></blockquote>
<p>This would be the output of this function. It shows that the
energy of a given <cite>macro_mol</cite> is twice as large as the mean
energy of the population. The radius is half the average
molecular radius of the population and so on.</p>
<p>Now these values can be combined in a reasonable way. However,
that will have to be done by other normalization functions.
This one only scales relative to the population average.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>population</strong> (<a class="reference internal" href="mtk.ga.population.html#mtk.ga.population.Population" title="mtk.ga.population.Population"><em>Population</em></a>) – The population whose fitness values are normalized.</li>
<li><strong>Modifies</strong> – </li>
<li><strong>--------</strong> – </li>
<li><strong>fitness</strong> (<em>numpy.array</em>) – This attribute is altered for the populations members.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>None</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">NoneType</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mtk.ga.normalization.Normalization.shift_elements">
<code class="descname">shift_elements</code><span class="sig-paren">(</span><em>population</em>, <em>indices</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mtk/ga/normalization.html#Normalization.shift_elements"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mtk.ga.normalization.Normalization.shift_elements" title="Permalink to this definition">¶</a></dt>
<dd><p>Maps elements in <cite>fitness</cite> array to positive values.</p>
<p>Assumy you have a fitness array,</p>
<blockquote>
<div>macro_mol.fitness = [1, -10, 1]</div></blockquote>
<p>One way to convert the fitness array into a fitness value is
by summing the elements (see the combine() normalization
function for this)</p>
<blockquote>
<div>macro_mol.fitness = -8</div></blockquote>
<p>Clearly this doesn’t work, because the resulting fitness value
is not a positive number. To fix this the -10 should be shifted
to a positive value.</p>
<p>This normalization function looks at the elements specified by
by <cite>indices</cite>. It then finds the minimum value of these elements
in the population. It then shifts the elements by this value.</p>
<p>For example, take a population of</p>
<blockquote>
<div>mol1.fitness = [1, -5, 5]
mol2.fitness = [3, -10, 2]
mol3.fitness = [2, 20, 1]</div></blockquote>
<p>If the value of <cite>indices</cite> was [1] the after this normalization
function was applied the result would be</p>
<blockquote>
<div>mol1.fitness = [1, 5.1, 5]
mol2.fitness = [3, 0.1, 2]
mol3.fitness = [2, 30.1, 1]</div></blockquote>
<p>If <cite>indices</cite> was [0,1]</p>
<blockquote>
<div>mol1.fitness = [2.01, 5.1, 5]
mol2.fitness = [4.01, 0.1, 2]
mol3.fitness = [3.01, 30.1, 1]</div></blockquote>
<p>The shift is  1.01 * magnitude of smallest value. This prevents
0s in the array.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>indices</strong> (<em>list of ints</em>) – This holds the indices of elements in the <cite>fitness</cite>
array which should be shifted to positive values.</li>
<li><strong>Modifies</strong> – </li>
<li><strong>--------</strong> – </li>
<li><strong>fitness</strong> (<em>numpy.array</em>) – The <cite>fitness</cite> atttribute of the population’s members is
changed in accordance to the docstring.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>None</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">NoneType</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Lukas Turcani.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>